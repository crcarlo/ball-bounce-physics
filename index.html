<html>
  <head>
    <title>Ball bounce physics</title>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="style.scss" />
  </head>

  <body>
    <div id="article" class="article">
      <h1>Ball bounce physics</h1>
      <p>
        In this article I am discussing a possible aproach on how to implement a
        collision detection and bounce beaviour of a 2D circular moving object
        on other static objects.<br /><br />
        In this article you will find interactive examples.
      </p>
      <h2>The problem</h2>
      <p>
        Imagine you are writing a simulation or a game that involves some kind
        of ball physics, like Pinball or Pachinko. <br />
        <br />
        I'm assuming that the simulation involves a cycle of update of the ball
        position depending on the velocity and position of the previous state.
        <br />
        <br />
        So you have a ball object that on a certain moment t_n is located in A
        and on t_n+1 is on B. <br />
        <br />
      </p>
      <div class="interactive-example" id="movingBall"></div>
      <span> Fig. 1 </span>
      <p>
        What may happen is that at a certain point the next state of the ball is
        invalid because of a collision with another object (like a peg for
        example). <br />
        <br />
        In this case we will consider a collision with a static ball (I.E. that
        won't move) centered in C.
      </p>
      <div class="interactive-example" id="circleLineIntersection"></div>
      <span> Fig. 2 </span>
      <p>
        At this point we might want to find a new valid state for our moving
        ball by detecting the collision and following a bounce behaviour.
        <br />
        <br />
        This means we want to find a new valid state for our ball. How?
      </p>
      <div class="interactive-example" id="theProblem"></div>
      <span> Fig. 3 </span>
      <h2>The simplified problem</h2>
      First of all. How do we find out if the next state is colliding? <br />
      <br />
      That's pretty simple. We can just see of the distance between the center
      of our ball in the next state is colliding with the static object. <br />
      <br />
      If the distance is less than the sum of the radii then is colliding,
      otherwise it is not.
      <div class="interactive-example" id="collisionDetection"></div>
      <span> Fig. 4 </span>
      <p>Where</p>
      <code>
        function distance(B, C) {<br />
        &nbsp; const dx = C.x - B.x; <br />
        &nbsp; const dy = C.y - B.y; <br />
        &nbsp; return Math.sqrt(dx * dx + dy * dy); <br />
        }
      </code>
      <p>
        Now that we have discovered a collision how do we find the bounce
        effect? <br />
        <br />
        Calculating the bounce effect of circular objects might seem
        complicated. Let's try a simpler aproach. <br />
        <br />
        We might notice that the collision detection and the desired behaviour
        is the same that we would obtain by calculating the same effect with a
        single point and a ball of radius equal to the sum of the two balls.
        <br />
        <br />
        I won't demonstrate that in this article. But you might get convinced by
        taking a look at the example below where I'll reproduce the same problem
        in this way.
      </p>
      <div class="interactive-example" id="collisionDetectionSingleBall"></div>
      <span> Fig. 5 </span>
      <h2>Circle-line intersection</h2>
    </div>

    <script src="src/index.ts"></script>
  </body>
</html>
